\hypertarget{tiff__util_8h}{\section{/mnt/c/\-A\-B\-C/\-C\-S/github/\-Facial-\/\-Recognition/src/libs/tiff\-\_\-util.h File Reference}
\label{tiff__util_8h}\index{/mnt/c/\-A\-B\-C/\-C\-S/github/\-Facial-\/\-Recognition/src/libs/tiff\-\_\-util.\-h@{/mnt/c/\-A\-B\-C/\-C\-S/github/\-Facial-\/\-Recognition/src/libs/tiff\-\_\-util.\-h}}
}


File containing common libtiff wrapper functions.  


{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$tiffio.\-h$>$}\\*
{\ttfamily \#include \char`\"{}linalg.\-h\char`\"{}}\\*
Include dependency graph for tiff\-\_\-util.\-h\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tiff__util_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{tiff__util_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{linalg_8h_a07a01529159cc35e78c1f7731ac7bda6}{vector} $\ast$ \hyperlink{tiff__util_8h_a62e9f072f6cc2973ba744946e6a4c5c3}{tiff\-\_\-to\-\_\-vec} (char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Converts tiff to vector this function will take a T\-I\-F\-F filename and return a vector$\ast$ with every element corresponding to pixel. \end{DoxyCompactList}\item 
T\-I\-F\-F $\ast$ \hyperlink{tiff__util_8h_aa0f92f2f91378e3700ee3eb5802444b5}{vec\-\_\-to\-\_\-tiff} (char $\ast$filename, \hyperlink{linalg_8h_a07a01529159cc35e78c1f7731ac7bda6}{vector} $\ast$vec)
\begin{DoxyCompactList}\small\item\em Converts vector to tiff this function will take a vector and return a T\-I\-F\-F$\ast$ with every element corresponding to pixel. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
File containing common libtiff wrapper functions. Minhyuk Park \begin{DoxyDate}{Date}
9 Nov 2017 
\end{DoxyDate}


\subsection{Function Documentation}
\hypertarget{tiff__util_8h_a62e9f072f6cc2973ba744946e6a4c5c3}{\index{tiff\-\_\-util.\-h@{tiff\-\_\-util.\-h}!tiff\-\_\-to\-\_\-vec@{tiff\-\_\-to\-\_\-vec}}
\index{tiff\-\_\-to\-\_\-vec@{tiff\-\_\-to\-\_\-vec}!tiff_util.h@{tiff\-\_\-util.\-h}}
\subsubsection[{tiff\-\_\-to\-\_\-vec}]{\setlength{\rightskip}{0pt plus 5cm}{\bf vector}$\ast$ tiff\-\_\-to\-\_\-vec (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{filename}
\end{DoxyParamCaption}
)}}\label{tiff__util_8h_a62e9f072f6cc2973ba744946e6a4c5c3}


Converts tiff to vector this function will take a T\-I\-F\-F filename and return a vector$\ast$ with every element corresponding to pixel. 

\begin{DoxyReturn}{Returns}
vector$\ast$ newly malloced representing the image 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em filename} & char$\ast$ the input filename \\
\hline
\end{DoxyParams}


References \-\_\-vector\-::padding, V\-E\-C, and vector\-\_\-create().


\begin{DoxyCode}
11                                     \{
12     TIFF* image = TIFFOpen(filename, \textcolor{stringliteral}{"r"});
13     uint32 width;
14     uint32 height;
15     TIFFGetField(image, TIFFTAG\_IMAGEWIDTH, &width);
16     TIFFGetField(image, TIFFTAG\_IMAGELENGTH, &height);
17 
18     uint32 num\_pixels = width * height;
19     uint32 * raster=(uint32*) \_TIFFmalloc(num\_pixels * \textcolor{keyword}{sizeof}(uint32));
20     \hyperlink{struct__vector}{vector}* retvec = \hyperlink{linalg_8c_a7040be230e99648e77b0932600bf55ef}{vector\_create}(num\_pixels);
21 
22     TIFFReadRGBAImage(image, width, height, raster, 0);
23 
24     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < num\_pixels; i ++) \{
25         \hyperlink{linalg_8h_a03e904294c904b01194a25323fc2f6ec}{VEC}(retvec, i) = *(raster + i);
26     \}
27     \_TIFFfree(raster);
28 
29     retvec->\hyperlink{struct__vector_a4165a40cc39bfd874677299c943b290f}{padding} = width;
30     TIFFClose(image);
31     \textcolor{keywordflow}{return} retvec;
32 \}
\end{DoxyCode}
\hypertarget{tiff__util_8h_aa0f92f2f91378e3700ee3eb5802444b5}{\index{tiff\-\_\-util.\-h@{tiff\-\_\-util.\-h}!vec\-\_\-to\-\_\-tiff@{vec\-\_\-to\-\_\-tiff}}
\index{vec\-\_\-to\-\_\-tiff@{vec\-\_\-to\-\_\-tiff}!tiff_util.h@{tiff\-\_\-util.\-h}}
\subsubsection[{vec\-\_\-to\-\_\-tiff}]{\setlength{\rightskip}{0pt plus 5cm}T\-I\-F\-F$\ast$ vec\-\_\-to\-\_\-tiff (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{filename, }
\item[{{\bf vector} $\ast$}]{vec}
\end{DoxyParamCaption}
)}}\label{tiff__util_8h_aa0f92f2f91378e3700ee3eb5802444b5}


Converts vector to tiff this function will take a vector and return a T\-I\-F\-F$\ast$ with every element corresponding to pixel. 

\begin{DoxyReturn}{Returns}
T\-I\-F\-F$\ast$ opened tiff file stream with necessary data written to from the vector 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em filename} & char$\ast$ the output filename \\
\hline
{\em vec} & vector$\ast$ vector representing the image \\
\hline
\end{DoxyParams}


References \-\_\-vector\-::padding, \-\_\-vector\-::size, and V\-E\-C.


\begin{DoxyCode}
35                                                \{
36     TIFF* rettiff = TIFFOpen(filename, \textcolor{stringliteral}{"w"});
37     uint32 width = vec->\hyperlink{struct__vector_a4165a40cc39bfd874677299c943b290f}{padding};
38     uint32 height = vec->\hyperlink{struct__vector_a1ed8dca78f3e589deb8dad9b53aec3fa}{size} / vec->\hyperlink{struct__vector_a4165a40cc39bfd874677299c943b290f}{padding};
39 
40     \textcolor{keywordtype}{char}* image\_char = malloc(vec->\hyperlink{struct__vector_a1ed8dca78f3e589deb8dad9b53aec3fa}{size} * 4); \textcolor{comment}{// 4 since RGBA}
41 
42     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < vec->\hyperlink{struct__vector_a1ed8dca78f3e589deb8dad9b53aec3fa}{size}; i ++) \{
43         image\_char[4 * i] = (char)TIFFGetR((uint32)\hyperlink{linalg_8h_a03e904294c904b01194a25323fc2f6ec}{VEC}(vec, i));
44         image\_char[4 * i + 1] = (char)TIFFGetG((uint32)\hyperlink{linalg_8h_a03e904294c904b01194a25323fc2f6ec}{VEC}(vec, i));
45         image\_char[4 * i + 2] = (char)TIFFGetB((uint32)\hyperlink{linalg_8h_a03e904294c904b01194a25323fc2f6ec}{VEC}(vec, i));
46         image\_char[4 * i + 3] = (char)TIFFGetA((uint32)\hyperlink{linalg_8h_a03e904294c904b01194a25323fc2f6ec}{VEC}(vec, i));
47     \}
48     TIFFSetField (rettiff, TIFFTAG\_IMAGEWIDTH, width);
49     TIFFSetField(rettiff, TIFFTAG\_IMAGELENGTH, height);
50     TIFFSetField(rettiff, TIFFTAG\_SAMPLESPERPIXEL, 4);
51     TIFFSetField(rettiff, TIFFTAG\_BITSPERSAMPLE, 8);
52     TIFFSetField(rettiff, TIFFTAG\_ORIENTATION, ORIENTATION\_TOPLEFT);
53     TIFFSetField(rettiff, TIFFTAG\_PLANARCONFIG, PLANARCONFIG\_CONTIG);
54     TIFFSetField(rettiff, TIFFTAG\_PHOTOMETRIC, PHOTOMETRIC\_RGB);
55 
56     tsize\_t linebytes = 4 * width;
57     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* buf = NULL;
58 
59     \textcolor{keywordflow}{if} (TIFFScanlineSize(rettiff) == linebytes) \{
60         buf =(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)\_TIFFmalloc(linebytes);
61     \} \textcolor{keywordflow}{else} \{
62         buf = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)\_TIFFmalloc(TIFFScanlineSize(rettiff));
63     \}
64 
65     TIFFSetField(rettiff, TIFFTAG\_ROWSPERSTRIP, TIFFDefaultStripSize(rettiff, width * 4));
66 
67     \textcolor{keywordflow}{for} (uint32 i = 0; i < height; i++)
68     \{
69         memcpy(buf, &image\_char[(height - i - 1) * linebytes], linebytes);
70         \textcolor{keywordflow}{if} (TIFFWriteScanline(rettiff, buf, i, 0) < 0) \{
71             \textcolor{keywordflow}{break};
72         \}
73     \}
74     \_TIFFfree(buf);
75     free(image\_char);
76     \textcolor{keywordflow}{return} rettiff;
77 \}\end{DoxyCode}
